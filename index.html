<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>RYFN DJ Maker | Pro Studio Titanium</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #0d0d0f; --panel: #1a1a1c; --neon: #3cefff; --accent: #ff3c78; --text: #d1d1d1; }
        body { margin: 0; background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; overflow: hidden; }
        
        /* å´é‚Šå°èˆª (èˆ‡å°ˆæ¥­ä»‹é¢æ•´åˆ) */
        #sidebar { position: fixed; left: -320px; top: 0; width: 300px; height: 100%; background: rgba(20,20,22,0.98); border-right: 2px solid var(--neon); transition: 0.4s; z-index: 9999; }
        #sidebar.active { left: 0; }
        .menu-trigger { position: fixed; top: 20px; left: 20px; z-index: 10000; cursor: pointer; color: var(--neon); font-size: 24px; background: #000; padding: 5px 15px; border: 1px solid var(--neon); border-radius: 5px; }

        .stage { display: none; width: 100vw; height: 100vh; padding: 80px 20px 20px; box-sizing: border-box; }
        .stage.active { display: block; }

        /* --- DJ å°ˆæ¥­é»‘è† ä»‹é¢ (ä»¿ djay) --- */
        .dj-container { display: grid; grid-template-columns: 1fr 200px 1fr; gap: 10px; height: 90%; }
        .deck { background: #151517; border: 1px solid #333; border-radius: 10px; padding: 20px; display: flex; flex-direction: column; align-items: center; position: relative; }
        .turntable { width: 320px; height: 320px; background: radial-gradient(circle, #333 2%, #111 10%, #000 100%); border-radius: 50%; border: 10px solid #222; position: relative; box-shadow: 0 0 30px rgba(0,0,0,1); display: flex; align-items: center; justify-content: center; }
        .turntable::after { content: ""; position: absolute; width: 100%; height: 100%; border-radius: 50%; background: repeating-radial-gradient(circle, transparent 0, transparent 2px, rgba(255,255,255,0.02) 3px); }
        .vinyl-label { width: 100px; height: 100px; background: var(--neon); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #000; font-weight: bold; font-family: 'Orbitron'; font-size: 10px; text-align: center; }
        .spinning { animation: rotateVinyl 2s linear infinite; }
        @keyframes rotateVinyl { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* å°ˆæ¥­æ¨å­ (ä»¿ djay EQ é¢æ¿) */
        .eq-faders { display: flex; gap: 20px; margin-top: 20px; background: #000; padding: 15px; border-radius: 8px; }
        .fader-group { display: flex; flex-direction: column; align-items: center; }
        input[type="range"][orient="vertical"] { appearance: slider-vertical; width: 8px; height: 150px; background: #333; }

        /* --- Synth One æ“¬çœŸé¢æ¿ --- */
        .synth-panel { background: #1c1c1e; border: 2px solid #444; padding: 20px; display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; border-radius: 5px; }
        .osc-box { border: 1px solid #333; padding: 10px; background: #111; border-top: 3px solid var(--neon); }
        .knob-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; text-align: center; font-size: 10px; }
        .knob-cap { width: 40px; height: 40px; background: #333; border: 2px solid #555; border-radius: 50%; margin: 5px auto; position: relative; cursor: ns-resize; }
        .knob-cap::before { content: ""; position: absolute; top: 5px; left: 50%; width: 2px; height: 10px; background: orange; transform-origin: bottom; }

        /* éµç›¤ */
        .piano-container { display: flex; justify-content: center; margin-top: 30px; position: relative; }
        .key { width: 45px; height: 220px; background: white; border: 1px solid #ccc; border-radius: 0 0 5px 5px; cursor: pointer; z-index: 1; }
        .key.black { width: 30px; height: 130px; background: #000; margin-left: -15px; margin-right: -15px; z-index: 2; border: 1px solid #555; }
        .key:active { background: var(--neon); }

        /* --- 8x8 æ–¹æ ¼ --- */
        .launchpad { display: grid; grid-template-columns: repeat(8, 60px); gap: 8px; justify-content: center; }
        .pad-unit { width: 60px; height: 60px; background: #222; border-radius: 4px; border-bottom: 4px solid #000; cursor: pointer; }
        .pad-unit.active { background: var(--accent); box-shadow: 0 0 20px var(--accent); }

        h2 { font-family: 'Orbitron'; text-transform: uppercase; letter-spacing: 2px; color: var(--neon); }
    </style>
</head>
<body>

    <div class="menu-trigger" onclick="document.getElementById('sidebar').classList.toggle('active')">â˜°</div>

    <nav id="sidebar">
        <div style="padding: 40px 20px; text-align: center; border-bottom: 1px solid #333;">
            <h2 style="margin:0">RYFN PRO</h2>
            <small style="color:var(--accent)">Master Edition 2026</small>
        </div>
        <div class="nav-item" onclick="switchPage('dj-page')" style="padding: 20px; cursor:pointer;">ğŸ§ å°ˆæ¥­é»‘è† æ··éŸ³ (Mixer)</div>
        <div class="nav-item" onclick="switchPage('pad-page')" style="padding: 20px; cursor:pointer;">ğŸ”³ 8x8 æ¡æ¨£è§¸ç™¼å™¨ (Sampler)</div>
        <div class="nav-item" onclick="switchPage('synth-page')" style="padding: 20px; cursor:pointer;">ğŸ¹ åˆæˆå™¨ VST (Synth One)</div>
        <div class="nav-item" onclick="switchPage('help-page')" style="padding: 20px; cursor:pointer; border-top: 1px solid #333;">â“ å°ˆæ¥­ä½¿ç”¨æ‰‹å†Š</div>
    </nav>

    <section id="dj-page" class="stage active">
        <div class="dj-container">
            <div class="deck">
                <div class="turntable" id="turntable-a"><div class="vinyl-label">DECK A<br>RYFN</div></div>
                <input type="file" id="up-a" style="margin-top:10px;">
                <div class="eq-faders">
                    <div class="fader-group"><input type="range" orient="vertical" min="-20" max="20" oninput="d1.eq.low.value=this.value"><small>LOW</small></div>
                    <div class="fader-group"><input type="range" orient="vertical" min="-20" max="20" oninput="d1.eq.mid.value=this.value"><small>MID</small></div>
                    <div class="fader-group"><input type="range" orient="vertical" min="-20" max="20" oninput="d1.eq.high.value=this.value"><small>HIGH</small></div>
                    <div class="fader-group" style="margin-left:20px; border-left: 1px solid #333; padding-left:10px;"><input type="range" orient="vertical" min="-40" max="10" oninput="d1.vol.volume.value=this.value"><small>VOL</small></div>
                </div>
                <button onclick="togglePlay('a')" style="margin-top:20px; width: 100%; padding:10px; background:var(--neon); border:none; font-weight:bold;">CUE / PLAY</button>
            </div>

            <div style="display:flex; flex-direction:column; align-items:center; justify-content:center;">
                <h3 style="color:orange">MASTER</h3>
                <input type="range" orient="vertical" style="height:250px;" oninput="Tone.Destination.volume.value=this.value">
                <div style="height:50px;"></div>
                <input type="range" min="0" max="1" step="0.01" oninput="xfade.fade.value = this.value">
                <small>CROSSFADER</small>
            </div>

            <div class="deck">
                <div class="turntable" id="turntable-b"><div class="vinyl-label" style="background:var(--accent)">DECK B<br>RYFN</div></div>
                <input type="file" id="up-b" style="margin-top:10px;">
                <div class="eq-faders">
                    <div class="fader-group" style="margin-right:20px; border-right: 1px solid #333; padding-right:10px;"><input type="range" orient="vertical" min="-40" max="10" oninput="d2.vol.volume.value=this.value"><small>VOL</small></div>
                    <div class="fader-group"><input type="range" orient="vertical" min="-20" max="20" oninput="d2.eq.low.value=this.value"><small>LOW</small></div>
                    <div class="fader-group"><input type="range" orient="vertical" min="-20" max="20" oninput="d2.eq.mid.value=this.value"><small>MID</small></div>
                    <div class="fader-group"><input type="range" orient="vertical" min="-20" max="20" oninput="d2.eq.high.value=this.value"><small>HIGH</small></div>
                </div>
                <button onclick="togglePlay('b')" style="margin-top:20px; width: 100%; padding:10px; background:var(--accent); color:white; border:none; font-weight:bold;">CUE / PLAY</button>
            </div>
        </div>
    </section>

    <section id="synth-page" class="stage">
        <div class="synth-panel">
            <div class="osc-box">
                <h4>OSC 1</h4>
                <div class="knob-grid">
                    <div><div class="knob-cap"></div>Semitones</div>
                    <div><div class="knob-cap" style="transform:rotate(40deg)"></div>Pulse Width</div>
                </div>
            </div>
            <div class="osc-box">
                <h4>OSC 2</h4>
                <div class="knob-grid">
                    <div><div class="knob-cap"></div>Detune</div>
                    <div><div class="knob-cap"></div>Waveform</div>
                </div>
            </div>
            <div class="osc-box" style="border-top-color: orange;">
                <h4>FILTER</h4>
                <div class="knob-grid">
                    <div><div class="knob-cap" id="f-cut"></div>Frequency</div>
                    <div><div class="knob-cap"></div>Resonance</div>
                </div>
            </div>
            <div class="osc-box" style="border-top-color: var(--accent);">
                <h4>ENVELOPE</h4>
                <div class="knob-grid">
                    <div><div class="knob-cap"></div>Attack</div>
                    <div><div class="knob-cap"></div>Release</div>
                </div>
            </div>
        </div>
        <div class="piano-container" id="piano"></div>
    </section>

    <section id="pad-page" class="stage">
        <div class="launchpad" id="launchpad-grid"></div>
    </section>

    <section id="help-page" class="stage">
        <div style="max-width:800px; margin:0 auto; background:#111; padding:40px; border-radius:10px; line-height:1.8;">
            <h1 style="color:var(--neon)">RYFN DJ Maker å°ˆæ¥­ç´šæŒ‡å—</h1>
            <p>1. <strong>å°ˆæ¥­æ··éŸ³å°ï¼š</strong>æ”¯æ´é›™è»Œç¨ç«‹ EQ è™•ç†ï¼ˆä»¿ djay é‚è¼¯ï¼‰ã€‚è«‹å…ˆä¸Šå‚³éŸ³æª”ï¼ŒæŒ‰ä¸‹æ’­æ”¾å¾Œè½‰ç›¤æœƒé–‹å§‹æ—‹è½‰ã€‚ä¸­æ–·åˆ‡æ›é é¢æ™‚éŸ³æ¨‚æœƒæŒçºŒæ’­æ”¾ã€‚</p>
            <p>2. <strong>Synth One æ¨¡æ“¬å™¨ï¼š</strong>æ¯å€‹æ—‹éˆ•éƒ½å°æ‡‰ Web Audio çš„ VST åƒæ•¸ã€‚éµç›¤æ”¯æ´è¤‡éŸ³ï¼ˆåŒæ™‚æŒ‰ä¸‹å¤šå€‹éµï¼‰ã€‚</p>
            <p>3. <strong>8x8 æ–¹æ ¼ï¼š</strong>å°ˆç‚ºç¾å ´è¡¨æ¼”è¨­è¨ˆï¼Œå¯è§¸ç™¼åœ˜éšŠé è¨­æ¡æ¨£ã€‚</p>
        </div>
    </section>

    <script>
        // --- æ ¸å¿ƒéŸ³è¨Šè¨­å®š ---
        const xfade = new Tone.CrossFade(0.5).toDestination();
        function setupDeck(bus) {
            const player = new Tone.Player({ loop: true });
            const eq = new Tone.EQ3(0, 0, 0);
            const vol = new Tone.Volume(0);
            player.chain(eq, vol, bus);
            return { player, eq, vol };
        }
        const d1 = setupDeck(xfade.a);
        const d2 = setupDeck(xfade.b);
        const polySynth = new Tone.PolySynth().toDestination();

        // --- é é¢æ§åˆ¶ ---
        function switchPage(id) {
            document.querySelectorAll('.stage').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.getElementById('sidebar').classList.remove('active');
        }

        // --- DJ åŠŸèƒ½ ---
        document.getElementById('up-a').onchange = async e => d1.player.load(URL.createObjectURL(e.target.files[0]));
        document.getElementById('up-b').onchange = async e => d2.player.load(URL.createObjectURL(e.target.files[0]));

        function togglePlay(deck) {
            const target = deck === 'a' ? d1.player : d2.player;
            const turntable = document.getElementById(`turntable-${deck}`);
            if (target.state === 'started') {
                target.stop();
                turntable.classList.remove('spinning');
            } else {
                if(target.loaded) {
                    target.start();
                    turntable.classList.add('spinning');
                } else alert("è«‹å…ˆè¼‰å…¥æ›²ç›®ï¼");
            }
        }

        // --- ç”Ÿæˆ 8x8 æ–¹æ ¼ ---
        const padGrid = document.getElementById('launchpad-grid');
        for(let i=0; i<64; i++) {
            const p = document.createElement('div');
            p.className = 'pad-unit';
            p.onclick = () => {
                p.classList.add('active');
                polySynth.triggerAttackRelease("C2", "16n");
                setTimeout(() => p.classList.remove('active'), 100);
            };
            padGrid.appendChild(p);
        }

        // --- ç”Ÿæˆé‹¼ç´éµç›¤ ---
        const piano = document.getElementById('piano');
        const notes = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];
        for(let oct=3; oct<5; oct++) {
            notes.forEach(n => {
                const k = document.createElement('div');
                k.className = n.includes('#') ? 'key black' : 'key';
                k.onmousedown = () => polySynth.triggerAttack(`${n}${oct}`);
                k.onmouseup = () => polySynth.triggerRelease(`${n}${oct}`);
                piano.appendChild(k);
            });
        }
    </script>
</body>
</html>
