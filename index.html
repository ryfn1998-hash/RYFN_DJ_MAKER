<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>RYFN DJ Maker | Team Pro Studio</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/nexusui@latest/dist/NexusUI.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Noto+Sans+TC:wght@300;500&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #0a0a0c; --panel: #16161d; --neon-cyan: #00f2ff; --neon-magenta: #ff00ff; --glass: rgba(255, 255, 255, 0.05); }
        body { margin: 0; background: var(--bg); color: #fff; font-family: 'Noto Sans TC', sans-serif; overflow: hidden; }
        
        /* å´é‚Šæ¬„èˆ‡å°èˆª */
        #sidebar { position: fixed; left: -300px; top: 0; width: 300px; height: 100%; background: var(--panel); transition: 0.5s cubic-bezier(0.2, 0.8, 0.2, 1); z-index: 3000; border-right: 1px solid var(--neon-cyan); display: flex; flex-direction: column; }
        #sidebar.active { left: 0; }
        .menu-btn { position: fixed; top: 25px; left: 25px; z-index: 3100; cursor: pointer; background: rgba(0,0,0,0.8); border: 1px solid var(--neon-cyan); color: var(--neon-cyan); padding: 10px; border-radius: 8px; font-family: 'Orbitron'; }
        .nav-item { padding: 18px 25px; border-bottom: 1px solid #222; cursor: pointer; transition: 0.3s; display: flex; align-items: center; gap: 15px; }
        .nav-item:hover { background: var(--neon-cyan); color: #000; }
        .nav-bottom { margin-top: auto; border-top: 1px solid #333; }

        /* ä»‹é¢ä½ˆå±€ */
        .page { display: none; padding: 80px 40px 40px 40px; height: 100vh; box-sizing: border-box; overflow-y: auto; }
        .page.active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* æ··éŸ³å™¨å¼·åŒ– */
        .mixer-grid { display: grid; grid-template-columns: 1fr 180px 1fr; gap: 20px; max-width: 1200px; margin: 0 auto; }
        .deck { background: var(--panel); border-radius: 15px; padding: 25px; border: 1px solid #333; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .viz-box { background: #000; height: 60px; border-radius: 5px; margin-bottom: 15px; border: 1px solid #444; }
        .deck-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; font-family: 'Orbitron'; color: var(--neon-cyan); }
        
        /* 8x8 Pad */
        .pad-wrapper { max-width: 600px; margin: 0 auto; display: grid; grid-template-columns: repeat(8, 1fr); gap: 10px; }
        .pad { aspect-ratio: 1; background: #2a2a35; border-radius: 6px; cursor: pointer; border-bottom: 4px solid #000; transition: 0.1s; }
        .pad:active { transform: scale(0.95); border-bottom-width: 0; }

        /* èªªæ˜æ›¸æ¨£å¼ */
        .help-card { background: var(--panel); padding: 30px; border-radius: 15px; max-width: 800px; margin: 0 auto; line-height: 1.8; border-left: 5px solid var(--neon-cyan); }
        code { color: var(--neon-magenta); background: #000; padding: 2px 6px; border-radius: 4px; }

        /* æ»‘å¡Šèˆ‡æ—‹éˆ•æ¨™ç±¤ */
        .label { font-size: 11px; text-align: center; color: #888; margin-top: 8px; text-transform: uppercase; letter-spacing: 1px; }
    </style>
</head>
<body>

    <button class="menu-btn" onclick="toggleMenu()">â˜° MENU</button>

    <nav id="sidebar">
        <div style="padding: 40px 25px;"><h2 style="font-family:'Orbitron'; color: var(--neon-cyan); margin:0;">RYFN PRO</h2><small>Team Music Station</small></div>
        <div class="nav-item" onclick="showPage('mixer')">ğŸ§ å°ˆæ¥­æ··éŸ³æ¯å¸¶å°</div>
        <div class="nav-item" onclick="showPage('pads')">ğŸ”³ 16-Step æ¡æ¨£æ–¹æ ¼</div>
        <div class="nav-item" onclick="showPage('synth')">ğŸ¹ åˆæˆå™¨ VST æ¨¡æ“¬</div>
        <div class="nav-item" onclick="showPage('editor')">âœ‚ï¸ å¿«é€ŸéŸ³é »ç·¨è¼¯</div>
        <div class="nav-bottom">
            <div class="nav-item" onclick="showPage('help')" style="color: var(--neon-magenta);">â“ ä½¿ç”¨èªªæ˜æ›¸</div>
        </div>
    </nav>

    <div id="mixer" class="page active">
        <div class="mixer-grid">
            <div class="deck">
                <div class="deck-header">DECK A <div id="meter-a"></div></div>
                <div id="scope-a" class="viz-box"></div>
                <input type="file" id="file-a" accept="audio/*">
                <div style="display: flex; gap: 20px; margin-top: 20px;">
                    <div style="flex: 1; display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div id="dial-a-h"></div><div id="dial-a-m"></div>
                        <div id="dial-a-l"></div><div id="dial-a-f"></div>
                    </div>
                    <div id="sld-a-v"></div>
                </div>
                <button onclick="play('a')" id="btn-play-a" style="width:100%; margin-top:15px; padding:10px; background:var(--neon-cyan); border:none; border-radius:5px; cursor:pointer; font-weight:bold;">PLAY / CUE</button>
            </div>

            <div class="center-strip" style="text-align: center; padding-top: 50px;">
                <div id="master-vol"></div><div class="label">Master</div>
                <div style="height: 100px;"></div>
                <div id="xfader"></div><div class="label">Crossfader</div>
                <div style="margin-top: 30px;">
                    <span id="bpm-display" style="font-family:'Orbitron'; font-size: 20px; color: var(--neon-cyan);">128</span><br>
                    <small class="label">BPM Sync</small>
                </div>
            </div>

            <div class="deck">
                <div class="deck-header">DECK B <div id="meter-b"></div></div>
                <div id="scope-b" class="viz-box"></div>
                <input type="file" id="file-b" accept="audio/*">
                <div style="display: flex; gap: 20px; margin-top: 20px;">
                    <div id="sld-b-v"></div>
                    <div style="flex: 1; display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div id="dial-b-h"></div><div id="dial-b-m"></div>
                        <div id="dial-b-l"></div><div id="dial-b-f"></div>
                    </div>
                </div>
                <button onclick="play('b')" id="btn-play-b" style="width:100%; margin-top:15px; padding:10px; background:var(--neon-magenta); border:none; border-radius:5px; cursor:pointer; font-weight:bold; color:white;">PLAY / CUE</button>
            </div>
        </div>
    </div>

    <div id="pads" class="page">
        <h2 style="text-align:center; font-family:'Orbitron';">DRUM & SAMPLE PAD</h2>
        <div class="pad-wrapper" id="pad-grid"></div>
    </div>

    <div id="synth" class="page">
        <div class="help-card" style="margin-bottom: 20px; text-align: center;">
            <h3 style="margin:0;">SYNTH ENGINE V1</h3>
            <p>é›™æŒ¯ç›ªå™¨åˆæˆå™¨ï¼Œæ”¯æ´å¤šé»è§¸æ§</p>
        </div>
        <div id="kb" style="width:100%;"></div>
        <div style="display:flex; justify-content:center; gap:30px; margin-top:40px;">
            <div id="s-atk"></div><div id="s-rel"></div><div id="s-cut"></div>
        </div>
    </div>

    <div id="editor" class="page">
        <div class="help-card">
            <h2>éŸ³é »å¾®èª¿ç·¨è¼¯å™¨</h2>
            <p>ä¸Šå‚³éŸ³è»Œå¾Œï¼Œæ‚¨å¯ä»¥èª¿æ•´å…¶åŸºç¤å±¬æ€§é€²è¡Œæ¯å¸¶é è¦½ã€‚</p>
            <input type="file" id="edit-in">
            <hr style="border:0; border-top:1px solid #333; margin:20px 0;">
            <div id="pitch-shifter"></div><div class="label">Pitch (éŸ³é«˜èª¿æ•´)</div>
        </div>
    </div>

    <div id="help" class="page">
        <div class="help-card">
            <h1 style="color: var(--neon-cyan); font-family: 'Orbitron';">RYFN DJ MAKER ä½¿ç”¨æ‰‹å†Š</h1>
            <p>æ­¡è¿ä½¿ç”¨å°ˆæ¥­éŸ³æ¨‚åœ˜éšŠå”ä½œå¹³å°ï¼Œä»¥ä¸‹æ˜¯å„æ¨¡çµ„çš„åŠŸèƒ½èªªæ˜ï¼š</p>
            
            <h3>1. å°ˆæ¥­æ··éŸ³æ¯å¸¶å° (Mixer)</h3>
            <ul>
                <li><strong>EQ ä¸‰æ®µç­‰åŒ–ï¼š</strong> æ¯å€‹ Deck æ“æœ‰ç¨ç«‹çš„ <code>High</code>, <code>Mid</code>, <code>Low</code> æ—‹éˆ•ã€‚</li>
                <li><strong>Filter æ¿¾æ³¢å™¨ï¼š</strong> æ—‹éˆ•è½‰è‡³å·¦å´ç‚ºä½é€š (LP)ï¼Œå³å´ç‚ºé«˜é€š (HP)ã€‚</li>
                <li><strong>Crossfaderï¼š</strong> æ§åˆ¶ A è»Œèˆ‡ B è»Œçš„éæ¸¡ã€‚</li>
            </ul>

            <h3>2. æ¡æ¨£æ–¹æ ¼ (Sampler)</h3>
            <ul>
                <li>å…§å»º 64 å€‹è§¸ç™¼å™¨ã€‚æ‚¨å¯ä»¥é»æ“Šä»»ä½•æ–¹æ ¼è§¸ç™¼å…§å»ºéŸ³æ•ˆã€‚</li>
                <li><em>åœ˜éšŠæŠ€å·§ï¼š</em> å»ºè­°åœ¨æ­¤åˆ†é åŠ å…¥åœ˜éšŠé–‹ç™¼çš„ Drum Kit éŸ³æ•ˆã€‚</li>
            </ul>

            <h3>3. åˆæˆå™¨ (Synth One)</h3>
            <ul>
                <li>é€™æ˜¯ä¸€å€‹ Polyphonicï¼ˆè¤‡éŸ³ï¼‰åˆæˆå™¨ã€‚</li>
                <li><strong>ADSR æ§åˆ¶ï¼š</strong> èª¿æ•´ Attack (èµ·éŸ³) èˆ‡ Release (é¤˜éŸ³) ä¾†æ”¹è®ŠéŸ³è‰²è³ªæ„Ÿã€‚</li>
            </ul>

            <h3>4. èƒŒæ™¯æ’­æ”¾èªªæ˜</h3>
            <p>æœ¬ç³»çµ±åŸºæ–¼å–®ä¸€ AudioContext é–‹ç™¼ï¼Œç•¶æ‚¨åœ¨æ··éŸ³å°é–‹å§‹æ’­æ”¾å¾Œï¼Œå¯ä»¥éš¨æ„åˆ‡æ›è‡³é‹¼ç´åˆ†é é€²è¡Œå³èˆˆæ¼”å¥ï¼Œè²éŸ³ä¸æœƒä¸­æ–·ã€‚</p>
            
            <p style="margin-top:40px; border-top:1px solid #444; padding-top:10px; font-size:12px; color:#666;">
                RYFN Team Version 2026.02 - è‡´åŠ›æ–¼æœ€ç›´è¦ºçš„éŸ³æ¨‚å‰µä½œç’°å¢ƒã€‚
            </p>
        </div>
    </div>

    <script>
        // --- æ ¸å¿ƒéŸ³è¨Šè¨­å®š ---
        const xf = new Tone.CrossFade().toDestination();
        const master = new Tone.Gain(0.9).connect(xf);
        
        function setupDeck(isA) {
            const player = new Tone.Player();
            const eq = new Tone.EQ3(0, 0, 0);
            const filter = new Tone.Filter(20000, "lowpass");
            const vol = new Tone.Volume(0);
            const meter = new Tone.Meter();
            
            player.chain(eq, filter, vol, meter, isA ? xf.a : xf.b);
            return { player, eq, filter, vol, meter };
        }

        const d1 = setupDeck(true);
        const d2 = setupDeck(false);
        const synth = new Tone.PolySynth().toDestination();

        // --- Nexus UI è¦–è¦ºåŒ–è¨­å®š ---
        Nexus.colors.accent = "#00f2ff";
        Nexus.colors.fill = "#2a2a35";

        const toggleMenu = () => document.getElementById('sidebar').classList.toggle('active');
        const showPage = (id) => {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            toggleMenu();
        };

        // --- æ··éŸ³å™¨å…ƒä»¶ç¶å®š ---
        // Deck A
        new Nexus.Dial('#dial-a-h', {label: 'H'}).on('change', v => d1.eq.high.value = v*20-10);
        new Nexus.Dial('#dial-a-m', {label: 'M'}).on('change', v => d1.eq.mid.value = v*20-10);
        new Nexus.Dial('#dial-a-l', {label: 'L'}).on('change', v => d1.eq.low.value = v*20-10);
        new Nexus.Dial('#dial-a-f', {label: 'F'}).on('change', v => d1.filter.frequency.value = v*10000);
        new Nexus.Slider('#sld-a-v', {size:[30,120]}).on('change', v => d1.vol.volume.value = Tone.gainToDb(v));

        // Deck B
        new Nexus.Dial('#dial-b-h').on('change', v => d2.eq.high.value = v*20-10);
        new Nexus.Dial('#dial-b-m').on('change', v => d2.eq.mid.value = v*20-10);
        new Nexus.Dial('#dial-b-l').on('change', v => d2.eq.low.value = v*20-10);
        new Nexus.Dial('#dial-b-f').on('change', v => d2.filter.frequency.value = v*10000);
        new Nexus.Slider('#sld-b-v', {size:[30,120]}).on('change', v => d2.vol.volume.value = Tone.gainToDb(v));

        new Nexus.Pan('#xfader', {size:[120,30]}).on('change', v => xf.fade.value = v.value);

        // --- æ’­æ”¾é‚è¼¯ ---
        const play = (d) => {
            const target = (d === 'a') ? d1.player : d2.player;
            if (target.state === 'started') target.stop();
            else if (target.loaded) target.start();
            else alert("è«‹å…ˆä¸Šå‚³éŸ³æª”ï¼");
        };

        document.getElementById('file-a').onchange = async e => d1.player.load(URL.createObjectURL(e.target.files[0]));
        document.getElementById('file-b').onchange = async e => d2.player.load(URL.createObjectURL(e.target.files[0]));

        // --- 8x8 Sampler ---
        const padGrid = document.getElementById('pad-grid');
        for(let i=0; i<64; i++) {
            const p = document.createElement('div');
            p.className = 'pad';
            p.style.backgroundColor = `hsl(${i * 5}, 50%, 40%)`;
            p.onclick = () => {
                synth.triggerAttackRelease("C2", "16n");
                p.style.filter = "brightness(2)";
                setTimeout(() => p.style.filter = "none", 100);
            };
            padGrid.appendChild(p);
        }

        // --- Synth One Piano ---
        new Nexus.Piano('#kb', {size: [1000, 200]}).on('change', v => {
            if(v.state) synth.triggerAttack(Tone.Frequency(v.note, "midi").toNote());
            else synth.triggerRelease(Tone.Frequency(v.note, "midi").toNote());
        });
    </script>
</body>
</html>
