<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>RYFN DJ Maker | å°ˆæ¥­éŸ³æ¨‚è£½ä½œæ•´åˆç³»çµ±</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --neon: #00f2ff; --magenta: #ff00ff; --panel: #121214; --bg: #050505; --gold: #ffd700; }
        body, html { margin: 0; padding: 0; height: 100%; background: var(--bg); color: #fff; font-family: 'Noto Sans TC', sans-serif; overflow: hidden; }

        /* é ‚éƒ¨ç‹€æ…‹æ¬„ (ä»¿ djay) */
        .top-bar { height: 60px; background: #000; border-bottom: 1px solid #333; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; z-index: 100; }
        .logo { font-family: 'Orbitron'; font-size: 20px; color: var(--neon); letter-spacing: 2px; }

        /* å´é‚Šå°èˆªç³»çµ± */
        #sidebar { position: fixed; left: -300px; top: 0; width: 300px; height: 100%; background: var(--panel); border-right: 2px solid var(--neon); transition: 0.4s; z-index: 2000; display: flex; flex-direction: column; }
        #sidebar.open { left: 0; }
        .menu-icon { cursor: pointer; color: var(--neon); font-size: 24px; padding: 15px; }

        /* ä¸»å·¥ä½œå€ */
        .workspace { height: calc(100vh - 60px); width: 100%; display: none; padding: 20px; box-sizing: border-box; }
        .workspace.active { display: block; }

        /* --- DJ æ——è‰¦æ¨¡çµ„ --- */
        .dj-engine { display: grid; grid-template-columns: 1fr 220px 1fr; gap: 20px; height: 100%; }
        .deck { background: #1a1a1c; border-radius: 15px; border: 1px solid #333; padding: 25px; position: relative; display: flex; flex-direction: column; align-items: center; }
        .vinyl-record { width: 300px; height: 300px; border-radius: 50%; background: radial-gradient(circle, #222 2%, #000 100%); border: 12px solid #1a1a1a; box-shadow: 0 0 30px rgba(0,0,0,0.8); display: flex; align-items: center; justify-content: center; position: relative; }
        .vinyl-record::after { content: ""; position: absolute; width: 100%; height: 100%; border-radius: 50%; background: repeating-radial-gradient(circle, transparent 0, transparent 2px, rgba(255,255,255,0.03) 3px); }
        .spinning { animation: rotate 1.8s linear infinite; }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* å°ˆæ¥­æ··éŸ³é€šé“æ¢ */
        .channel-strip { display: flex; gap: 15px; margin-top: 30px; background: #000; padding: 20px; border-radius: 12px; }
        .fader-unit { display: flex; flex-direction: column; align-items: center; gap: 8px; }
        .fader-unit span { font-size: 11px; color: #777; font-weight: bold; }
        input[type="range"][orient="vertical"] { appearance: slider-vertical; width: 10px; height: 160px; }

        /* --- Synth One æ“¬çœŸæ¨¡çµ„ --- */
        .synth-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; background: #1c1c1e; padding: 20px; border: 2px solid #333; border-radius: 5px; }
        .module { background: #111; border: 1px solid #444; padding: 15px; border-top: 4px solid var(--gold); }
        .module h4 { margin: 0 0 10px 0; font-size: 12px; color: var(--gold); text-transform: uppercase; }

        /* é‹¼ç´éµç›¤ (å¯¦é«”å°æ˜ ) */
        .piano-wrapper { display: flex; justify-content: center; height: 240px; margin-top: 40px; position: relative; background: #000; padding: 10px; border-radius: 10px; }
        .white-key { width: 45px; height: 100%; background: #fff; border: 1px solid #bbb; border-radius: 0 0 4px 4px; cursor: pointer; z-index: 1; transition: 0.1s; }
        .black-key { width: 32px; height: 65%; background: #222; border: 1px solid #444; margin: 0 -16px; z-index: 2; cursor: pointer; }
        .white-key:active, .black-key:active { background: var(--neon); }

        /* 8x8 æ–¹æ ¼ Launchpad */
        .pad-container { display: grid; grid-template-columns: repeat(8, 1fr); gap: 10px; max-width: 700px; margin: 0 auto; }
        .pad-cell { aspect-ratio: 1; background: #1a1a1f; border-radius: 4px; border-bottom: 5px solid #000; cursor: pointer; }
        .pad-cell:active { transform: translateY(3px); border-bottom-width: 1px; background: var(--magenta); box-shadow: 0 0 20px var(--magenta); }

        .btn-pro { padding: 12px 25px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; font-family: 'Orbitron'; }
    </style>
</head>
<body>

    <div class="top-bar">
        <div class="menu-icon" onclick="toggleSidebar()">â˜°</div>
        <div class="logo">RYFN TITAN PRO</div>
        <div style="color:var(--gold); font-family:'Orbitron';">BPM: 128</div>
    </div>

    <nav id="sidebar">
        <div style="padding: 40px 30px; border-bottom: 1px solid #333;"><h2 style="color:var(--neon); margin:0;">é¸å–®</h2></div>
        <div class="nav-item" onclick="showTab('dj-tab')" style="padding:20px; cursor:pointer;">ğŸ§ æ——è‰¦é›™è»Œæ··éŸ³ (Mixer)</div>
        <div class="nav-item" onclick="showTab('pad-tab')" style="padding:20px; cursor:pointer;">ğŸ”³ 8x8 å°ˆæ¥­æ¡æ¨£ (Sampler)</div>
        <div class="nav-item" onclick="showTab('synth-tab')" style="padding:20px; cursor:pointer;">ğŸ¹ Synth One æ ¸å¿ƒ (VST)</div>
        <div class="nav-item" onclick="showTab('help-tab')" style="padding:20px; cursor:pointer; margin-top:auto; background:#1a1a1c;">â“ ç¹é«”ä¸­æ–‡èªªæ˜æ›¸</div>
    </nav>

    <div id="dj-tab" class="workspace active">
        <div class="dj-engine">
            <div class="deck">
                <div class="vinyl-record" id="v-a"><div style="width:100px; height:100px; background:var(--neon); border-radius:50%; display:flex; align-items:center; justify-content:center; color:#000; font-weight:bold;">DECK A</div></div>
                <input type="file" id="load-a" style="margin-top:15px; font-size:12px;">
                <div class="channel-strip">
                    <div class="fader-unit"><input type="range" orient="vertical" min="-40" max="10" value="0" oninput="deckA.eq.low.value=this.value"><span>ä½éŸ³</span></div>
                    <div class="fader-unit"><input type="range" orient="vertical" min="-40" max="10" value="0" oninput="deckA.eq.mid.value=this.value"><span>ä¸­éŸ³</span></div>
                    <div class="fader-unit"><input type="range" orient="vertical" min="-40" max="10" value="0" oninput="deckA.eq.high.value=this.value"><span>é«˜éŸ³</span></div>
                    <div class="fader-unit"><input type="range" orient="vertical" min="0" max="100" value="100" oninput="deckA.filter.frequency.value=this.value*150"><span>æ¿¾æ³¢</span></div>
                    <div class="fader-unit" style="border-left:1px solid #333; padding-left:10px;"><input type="range" orient="vertical" min="-60" max="10" value="0" oninput="deckA.vol.volume.value=this.value"><span>éŸ³é‡</span></div>
                </div>
                <button class="btn-pro" onclick="controlDeck('a')" style="background:var(--neon); width:100%; margin-top:15px;">PLAY / STOP</button>
            </div>

            <div style="display:flex; flex-direction:column; align-items:center; justify-content:center;">
                <h4 style="color:var(--gold)">MASTER</h4>
                <input type="range" orient="vertical" style="height:250px;" oninput="Tone.Destination.volume.value = this.value">
                <div style="height:40px;"></div>
                <input type="range" min="0" max="1" step="0.01" style="width:180px;" oninput="crossfade.fade.value = this.value">
                <span style="font-size:12px; margin-top:5px;">CROSSFADER</span>
            </div>

            <div class="deck">
                <div class="vinyl-record" id="v-b"><div style="width:100px; height:100px; background:var(--magenta); border-radius:50%; display:flex; align-items:center; justify-content:center; color:#fff; font-weight:bold;">DECK B</div></div>
                <input type="file" id="load-b" style="margin-top:15px; font-size:12px;">
                <div class="channel-strip">
                    <div class="fader-unit" style="border-right:1px solid #333; padding-right:10px;"><input type="range" orient="vertical" min="-60" max="10" value="0" oninput="deckB.vol.volume.value=this.value"><span>éŸ³é‡</span></div>
                    <div class="fader-unit"><input type="range" orient="vertical" min="-40" max="10" value="0" oninput="deckB.eq.low.value=this.value"><span>ä½éŸ³</span></div>
                    <div class="fader-unit"><input type="range" orient="vertical" min="-40" max="10" value="0" oninput="deckB.eq.mid.value=this.value"><span>ä¸­éŸ³</span></div>
                    <div class="fader-unit"><input type="range" orient="vertical" min="-40" max="10" value="0" oninput="deckB.eq.high.value=this.value"><span>é«˜éŸ³</span></div>
                    <div class="fader-unit"><input type="range" orient="vertical" min="0" max="100" value="100" oninput="deckB.filter.frequency.value=this.value*150"><span>æ¿¾æ³¢</span></div>
                </div>
                <button class="btn-pro" onclick="controlDeck('b')" style="background:var(--magenta); color:#fff; width:100%; margin-top:15px;">PLAY / STOP</button>
            </div>
        </div>
    </div>

    <div id="pad-tab" class="workspace">
        <div style="text-align:center; margin-bottom:20px;">
            <h2 style="color:var(--magenta)">å°ˆæ¥­ 8x8 éŸ³æ•ˆè§¸ç™¼å™¨</h2>
            <select id="kit" style="background:#000; color:var(--neon); padding:10px; border:1px solid var(--neon);">
                <option>EDM éŸ³è‰²åŒ… V1</option>
                <option>Hip-Hop é¼“çµ„</option>
                <option>Future Bass æ¡æ¨£</option>
            </select>
        </div>
        <div class="pad-container" id="pad-matrix"></div>
    </div>

    <div id="synth-tab" class="workspace">
        <div class="synth-grid">
            <div class="module"><h4>OSC 1 (æŒ¯ç›ªå™¨)</h4><div style="font-size:10px;">æ³¢å½¢ï¼šé‹¸é½’æ³¢</div></div>
            <div class="module"><h4>FILTER (æ¿¾æ³¢å™¨)</h4><div style="font-size:10px;">åˆ‡æ³¢ï¼š1200Hz / å…±æŒ¯ï¼šQ 1.5</div></div>
            <div class="module"><h4>ADSR (åŒ…çµ¡ç·š)</h4><div style="font-size:10px;">èµ·éŸ³ï¼š5ms / è¡°æ¸›ï¼š200ms</div></div>
            <div class="module"><h4>LFO (èª¿è®Š)</h4><div style="font-size:10px;">é »ç‡ï¼š0.5Hz</div></div>
        </div>
        <div class="piano-wrapper" id="piano"></div>
    </div>

    <div id="help-tab" class="workspace">
        <div style="max-width:800px; margin:0 auto; background:var(--panel); padding:40px; border-radius:15px; border-left:5px solid var(--neon);">
            <h1 style="color:var(--neon)">RYFN PRO ä½¿ç”¨æŒ‡å— (ç¹é«”ä¸­æ–‡)</h1>
            <hr border="0" style="border-top:1px solid #333; margin:20px 0;">
            <h3>1. å¦‚ä½•è¼‰å…¥éŸ³æ¨‚ï¼Ÿ</h3>
            <p>åœ¨ DJ æ··éŸ³åˆ†é ä¸­ï¼Œé»æ“Š<strong>ã€Œé¸æ“‡æª”æ¡ˆã€</strong>ã€‚ç³»çµ±æœƒç«‹å³è§£ç¢¼éŸ³è¨Šã€‚è§£ç¢¼å®Œæˆå¾Œï¼ŒæŒ‰ä¸‹åº•éƒ¨çš„ <strong>PLAY</strong> éµã€‚è«‹ç¢ºä¿åœ¨æŒ‰ä¸‹æ’­æ”¾å‰ï¼ŒéŸ³è»Œå·²å®Œå…¨åŠ è¼‰ã€‚</p>
            <h3>2. å°ˆæ¥­æ··éŸ³é‚è¼¯</h3>
            <p>æ¯å€‹è»Œé“éƒ½æ“æœ‰ç¨ç«‹çš„ <strong>EQ3 (ä½/ä¸­/é«˜éŸ³)</strong>ã€‚ä½ å¯ä»¥é€éå‚ç›´æ¨å­ç²¾ç¢ºæ§åˆ¶é »ç‡è¡°æ¸›ã€‚ä¸­é–“çš„æ©«å‘æ¨å­ (Crossfader) ç”¨æ–¼éæ¸¡ A è»Œèˆ‡ B è»Œã€‚</p>
            <h3>3. åˆæˆå™¨èˆ‡æ¡æ¨£å™¨</h3>
            <p>åˆæˆå™¨æ”¯æ´<strong>è¤‡éŸ³ (Polyphonic)</strong>ï¼Œä½ å¯ä»¥åŒæ™‚å½ˆå¥å¤šå€‹é‹¼ç´éµã€‚æ¡æ¨£å™¨ (8x8) æœƒåœ¨è§¸ç™¼æ™‚ç™¼å‡ºå¼·çƒˆçš„è¦–è¦ºåé¥‹ï¼Œä¸¦æ”¯æ´å³æ™‚é»æ“Šã€‚</p>
            <p style="margin-top:40px; color:#666;">Â© 2026 RYFN Team. å°ˆç‚ºé«˜æ•ˆèƒ½éŸ³æ¨‚è£½ä½œè€Œç”Ÿã€‚</p>
        </div>
    </div>

    <script>
        // --- æ ¸å¿ƒéŸ³è¨Šæ‹“æ’² ---
        const crossfade = new Tone.CrossFade(0.5).toDestination();
        const mainLimiter = new Tone.Limiter(-1).toDestination();

        function createDeckChain(bus) {
            const player = new Tone.Player({ loop: true, autostart: false });
            const eq = new Tone.EQ3(0, 0, 0);
            const filter = new Tone.Filter(20000, "lowpass");
            const vol = new Tone.Volume(0);
            player.chain(eq, filter, vol, bus);
            return { player, eq, filter, vol };
        }

        const deckA = createDeckChain(crossfade.a);
        const deckB = createDeckChain(crossfade.b);
        const synth = new Tone.PolySynth(Tone.Synth).toDestination();

        // --- ä»‹é¢é‚è¼¯ ---
        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('open'); }
        function showTab(id) {
            document.querySelectorAll('.workspace').forEach(w => w.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            toggleSidebar();
        }

        // --- éŸ³è»Œè¼‰å…¥å¯¦ä½œ (ä¿®æ­£åŸæœ¬ç„¡æ³•æ’­æ”¾çš„å•é¡Œ) ---
        async function setupLoader(inputId, deck) {
            document.getElementById(inputId).onchange = async (e) => {
                const file = e.target.files[0];
                const url = URL.createObjectURL(file);
                await deck.player.load(url);
                console.log(`${inputId} åŠ è¼‰æˆåŠŸ`);
                alert("éŸ³è»Œå·²å°±ç·’ï¼Œè«‹æŒ‰ä¸‹ PLAY é–‹å§‹ã€‚");
            };
        }
        setupLoader('load-a', deckA);
        setupLoader('load-b', deckB);

        function controlDeck(id) {
            const target = id === 'a' ? deckA.player : deckB.player;
            const vinyl = document.getElementById(`v-${id}`);
            if(target.state === 'started') {
                target.stop();
                vinyl.classList.remove('spinning');
            } else {
                if(target.loaded) {
                    Tone.start();
                    target.start();
                    vinyl.classList.add('spinning');
                } else alert("è«‹å…ˆé¸æ“‡éŸ³æ¨‚æª”æ¡ˆä¸¦ç­‰å¾…è¼‰å…¥ï¼");
            }
        }

        // --- ç”Ÿæˆ 8x8 çŸ©é™£ ---
        const matrix = document.getElementById('pad-matrix');
        for(let i=0; i<64; i++) {
            const p = document.createElement('div');
            p.className = 'pad-cell';
            p.onclick = () => {
                Tone.start();
                synth.triggerAttackRelease("G2", "16n");
            };
            matrix.appendChild(p);
        }

        // --- ç”Ÿæˆé‹¼ç´ (å°æ‡‰ MIDI é‚è¼¯) ---
        const piano = document.getElementById('piano');
        const notes = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];
        for(let oct=3; oct<=4; oct++) {
            notes.forEach(n => {
                const k = document.createElement('div');
                k.className = n.includes('#') ? 'black-key' : 'white-key';
                k.onmousedown = () => { Tone.start(); synth.triggerAttack(`${n}${oct}`); };
                k.onmouseup = () => synth.triggerRelease(`${n}${oct}`);
                piano.appendChild(k);
            });
        }
    </script>
</body>
</html>
