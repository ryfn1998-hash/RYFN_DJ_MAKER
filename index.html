<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>RYFN DJ Maker | é ‚ç´šå°ˆæ¥­é›»å­éŸ³æ¨‚æ•´åˆç³»çµ±</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-deep: #050507; --panel: #111114; --neon-cyan: #00f2ff;
            --neon-pink: #ff0055; --gold: #d4af37; --glass: rgba(255, 255, 255, 0.03);
        }
        body {
            margin: 0; background: var(--bg-deep); color: #fff;
            font-family: 'Noto Sans TC', sans-serif; overflow: hidden;
        }

        /* å´é‚ŠæŠ½å±œèœå–® */
        #sidebar {
            position: fixed; left: -320px; top: 0; width: 320px; height: 100%;
            background: var(--panel); border-right: 2px solid var(--neon-cyan);
            transition: 0.5s cubic-bezier(0.16, 1, 0.3, 1); z-index: 10000;
            box-shadow: 20px 0 50px rgba(0,0,0,0.9); display: flex; flex-direction: column;
        }
        #sidebar.active { left: 0; }
        .menu-btn {
            position: fixed; top: 25px; left: 25px; z-index: 10001;
            cursor: pointer; background: #000; border: 1px solid var(--neon-cyan);
            padding: 8px 12px; border-radius: 4px; color: var(--neon-cyan);
        }

        /* å°è¦½é … */
        .nav-item {
            padding: 25px; border-bottom: 1px solid #222; cursor: pointer;
            font-size: 1.1rem; transition: 0.3s; display: flex; align-items: center; gap: 15px;
        }
        .nav-item:hover { background: var(--neon-cyan); color: #000; font-weight: bold; }

        /* ä¸»èˆå° */
        .page { display: none; width: 100vw; height: 100vh; padding: 100px 30px 30px; box-sizing: border-box; }
        .page.active { display: block; animation: zoomIn 0.3s ease-out; }
        @keyframes zoomIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }

        /* DJ å°ˆæ¥­ä»‹é¢ */
        .dj-grid { display: grid; grid-template-columns: 1fr 280px 1fr; gap: 20px; height: 85%; }
        .deck-pro { 
            background: var(--panel); border-radius: 20px; padding: 30px;
            border: 1px solid #333; position: relative; display: flex; flex-direction: column; align-items: center;
        }
        .turntable-vinyl {
            width: 320px; height: 320px; border-radius: 50%;
            background: radial-gradient(circle, #333 5%, #111 15%, #000 100%);
            border: 12px solid #1a1a1a; position: relative;
            box-shadow: 0 0 40px rgba(0,0,0,0.8), inset 0 0 20px rgba(255,255,255,0.05);
            display: flex; align-items: center; justify-content: center;
        }
        .center-label { width: 100px; height: 100px; border-radius: 50%; background: var(--neon-cyan); color: #000; font-weight: bold; display: flex; align-items: center; justify-content: center; font-size: 12px; }
        .spinning { animation: rotate 2s linear infinite; }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* å°ˆæ¥­æ¨å­èˆ‡æ—‹éˆ•å€ */
        .control-row { display: flex; gap: 20px; margin-top: 25px; background: #000; padding: 20px; border-radius: 15px; width: 100%; justify-content: space-around; }
        .fader-box { display: flex; flex-direction: column; align-items: center; gap: 10px; }
        .fader-box span { font-size: 10px; color: #888; letter-spacing: 1px; }
        input[type="range"][orient="vertical"] { appearance: slider-vertical; width: 12px; height: 180px; }

        /* Sampler 8x8 æ ¼å­ */
        .sampler-wrap { max-width: 800px; margin: 0 auto; }
        .lib-select { margin-bottom: 20px; text-align: center; }
        .pad-matrix { display: grid; grid-template-columns: repeat(8, 1fr); gap: 10px; }
        .pad { aspect-ratio: 1; background: #1a1a1f; border-radius: 5px; border-bottom: 5px solid #000; cursor: pointer; transition: 0.1s; position: relative; overflow: hidden; }
        .pad::after { content: ""; position: absolute; inset: 0; background: rgba(255,255,255,0.05); }
        .pad:active { transform: translateY(3px); border-bottom-width: 1px; background: var(--neon-pink); }

        /* Synth One é¢æ¿ */
        .synth-dashboard { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; background: #16161a; padding: 25px; border-radius: 10px; border: 1px solid #333; }
        .module { border: 1px solid #2a2a2e; padding: 15px; position: relative; }
        .module h4 { margin: 0 0 15px 0; color: var(--gold); border-bottom: 1px solid #333; padding-bottom: 5px; }

        /* é‹¼ç´éµç›¤ */
        .piano-keys { display: flex; justify-content: center; height: 250px; margin-top: 30px; position: relative; }
        .w-key { width: 50px; height: 100%; background: #eee; border: 1px solid #aaa; border-radius: 0 0 5px 5px; cursor: pointer; z-index: 1; }
        .b-key { width: 35px; height: 60%; background: #111; border: 1px solid #444; margin-left: -17.5px; margin-right: -17.5px; z-index: 2; cursor: pointer; }
        .w-key:active, .b-key:active { background: var(--neon-cyan); }

        /* èªªæ˜æ›¸ */
        .help-doc { max-width: 900px; margin: 0 auto; background: var(--panel); padding: 50px; border-radius: 20px; line-height: 2; border-left: 8px solid var(--neon-cyan); }
    </style>
</head>
<body>

    <div class="menu-btn" onclick="toggleSidebar()">â˜° é¸å–®</div>

    <nav id="sidebar">
        <div style="padding: 50px 30px; border-bottom: 1px solid #222;">
            <h1 style="font-family: 'Orbitron'; color: var(--neon-cyan); margin:0;">RYFN DJ MAKER</h1>
            <p style="font-size: 12px; color: var(--gold);">éˆ¦é‡‘å°ˆæ¥­åœ˜éšŠç‰ˆ v4.0</p>
        </div>
        <div class="nav-item" onclick="showPage('dj')">ğŸ§ å°ˆæ¥­é»‘è† æ··éŸ³å° (Mixer)</div>
        <div class="nav-item" onclick="showPage('sampler')">ğŸ”³ 8x8 é ‚ç´šæ¡æ¨£å™¨ (Sampler)</div>
        <div class="nav-item" onclick="showPage('synth')">ğŸ¹ Synth One åˆæˆå™¨æ ¸å¿ƒ</div>
        <div class="nav-item" onclick="showPage('editor')">âœ‚ï¸ éŸ³é »æ¯å¸¶è™•ç†å™¨ (Master)</div>
        <div class="nav-item" onclick="showPage('help')" style="margin-top:auto; color: var(--neon-pink);">â“ ç³»çµ±ä½¿ç”¨èªªæ˜</div>
    </nav>

    <section id="dj" class="page active">
        <div class="dj-grid">
            <div class="deck-pro">
                <div class="turntable-vinyl" id="vinyl-a"><div class="center-label">RYFN DECK A</div></div>
                <div style="margin: 20px 0;">
                    <label style="background:var(--neon-cyan); color:#000; padding:10px 20px; border-radius:5px; cursor:pointer; font-weight:bold;">
                        ä¸Šå‚³éŸ³è»Œ <input type="file" hidden onchange="loadBuffer(event, 'a')">
                    </label>
                </div>
                <div class="control-row">
                    <div class="fader-box"><input type="range" orient="vertical" min="-30" max="10" oninput="d1.eq.low.value=this.value"><span>ä½éŸ³</span></div>
                    <div class="fader-box"><input type="range" orient="vertical" min="-30" max="10" oninput="d1.eq.mid.value=this.value"><span>ä¸­éŸ³</span></div>
                    <div class="fader-box"><input type="range" orient="vertical" min="-30" max="10" oninput="d1.eq.high.value=this.value"><span>é«˜éŸ³</span></div>
                    <div class="fader-box"><input type="range" orient="vertical" min="0" max="20000" oninput="d1.filter.frequency.value=this.value"><span>æ¿¾æ³¢</span></div>
                </div>
                <button onclick="playDeck('a')" style="width:100%; margin-top:20px; padding:15px; border-radius:10px; background:var(--neon-cyan); border:none; font-weight:bold; cursor:pointer;">æ’­æ”¾ / åœæ­¢ (PLAY)</button>
            </div>

            <div style="display:flex; flex-direction:column; align-items:center; justify-content:center;">
                <h2 style="font-family:'Orbitron'; color:var(--gold);">MASTER</h2>
                <input type="range" orient="vertical" style="height:300px;" oninput="Tone.Destination.volume.value = Tone.gainToDb(this.value/100)">
                <div style="height:40px;"></div>
                <input type="range" min="0" max="1" step="0.01" value="0.5" style="width:200px;" oninput="xfade.fade.value = this.value">
                <span style="font-size:12px; margin-top:10px;">æ©«å‘æ¨å­ (CROSSFADER)</span>
            </div>

            <div class="deck-pro">
                <div class="turntable-vinyl" id="vinyl-b"><div class="center-label" style="background:var(--neon-pink); color:#fff;">RYFN DECK B</div></div>
                <div style="margin: 20px 0;">
                    <label style="background:var(--neon-pink); color:#fff; padding:10px 20px; border-radius:5px; cursor:pointer; font-weight:bold;">
                        ä¸Šå‚³éŸ³è»Œ <input type="file" hidden onchange="loadBuffer(event, 'b')">
                    </label>
                </div>
                <div class="control-row">
                    <div class="fader-box"><input type="range" orient="vertical" min="-30" max="10" oninput="d2.eq.low.value=this.value"><span>ä½éŸ³</span></div>
                    <div class="fader-box"><input type="range" orient="vertical" min="-30" max="10" oninput="d2.eq.mid.value=this.value"><span>ä¸­éŸ³</span></div>
                    <div class="fader-box"><input type="range" orient="vertical" min="-30" max="10" oninput="d2.eq.high.value=this.value"><span>é«˜éŸ³</span></div>
                    <div class="fader-box"><input type="range" orient="vertical" min="0" max="20000" oninput="d2.filter.frequency.value=this.value"><span>æ¿¾æ³¢</span></div>
                </div>
                <button onclick="playDeck('b')" style="width:100%; margin-top:20px; padding:15px; border-radius:10px; background:var(--neon-pink); color:#fff; border:none; font-weight:bold; cursor:pointer;">æ’­æ”¾ / åœæ­¢ (PLAY)</button>
            </div>
        </div>
    </section>

    <section id="sampler" class="page">
        <div class="sampler-wrap">
            <div class="lib-select">
                <button onclick="setSamplerLib('EDM')" style="padding:10px 20px;">EDM æ¨¡å¼</button>
                <button onclick="setSamplerLib('TRAP')" style="padding:10px 20px;">TRAP æ¨¡å¼</button>
                <button onclick="setSamplerLib('HOUSE')" style="padding:10px 20px;">HOUSE æ¨¡å¼</button>
            </div>
            <div class="pad-matrix" id="pad-container"></div>
        </div>
    </section>

    <section id="synth" class="page">
        <div class="synth-dashboard">
            <div class="module"><h4>æŒ¯ç›ªå™¨ (OSC 1)</h4><p>æ³¢å½¢: é‹¸é½’æ³¢</p></div>
            <div class="module"><h4>æ¿¾æ³¢å™¨ (LFO)</h4><p>åˆ‡æ³¢é »ç‡: 1.2k Hz</p></div>
            <div class="module"><h4>åŒ…çµ¡ç·š (ADSR)</h4><p>èµ·éŸ³æ™‚é–“: 0.1s</p></div>
        </div>
        <div class="piano-keys" id="piano"></div>
    </section>

    <section id="help" class="page">
        <div class="help-doc">
            <h1 style="color:var(--neon-cyan)">RYFN DJ Maker å°ˆæ¥­æ‰‹å†Š</h1>
            <hr border="0" style="border-top:1px solid #333;">
            <h3>ğŸ§ å°ˆæ¥­æ··éŸ³å° (Mixer)</h3>
            <p>é€™æ˜¯æ ¸å¿ƒæ··éŸ³æ¨¡çµ„ï¼Œå…·å‚™æ¨¡æ“¬é»‘è† è½‰ç›¤èˆ‡å››æ®µç¨ç«‹æ¨å­ã€‚<strong>ä½éŸ³ã€ä¸­éŸ³ã€é«˜éŸ³ã€æ¿¾æ³¢å™¨</strong> å‡æ¡ç”¨å°ˆæ¥­ $dB$ è¡°æ¸›æ›²ç·šã€‚</p>
            <h3>ğŸ”³ æ¡æ¨£å™¨ (Sampler)</h3>
            <p>8x8 å…± 64 å€‹æŒ‰éµï¼Œæ”¯æ´å³æ™‚è§¸ç™¼ã€‚æ‚¨å¯ä»¥åˆ‡æ›ä¸åŒçš„éŸ³æ•ˆåº«ï¼Œæ”¯æ´èƒŒæ™¯ç–ŠåŠ æ’­æ”¾ã€‚</p>
            <h3>ğŸ¹ åˆæˆå™¨ (VST)</h3>
            <p>æ¡ç”¨è¤‡éŸ³åˆæˆæŠ€è¡“ï¼Œæ”¯æ´å¤šé»è§¸æ§å½ˆå¥ã€‚é©åˆé€²è¡Œ Lead æˆ– Bass çš„ç·¨å¯«ã€‚</p>
            <p style="margin-top:50px; text-align:right; font-size:12px; opacity:0.5;">RYFN éŸ³æ¨‚åœ˜éšŠå°ˆç”¨ç³»çµ± | 2026 æ——è‰¦ç‰ˆ</p>
        </div>
    </section>

    <script>
        // --- 1. åˆå§‹åŒ–éŸ³è¨Šæ ¸å¿ƒ ---
        const xfade = new Tone.CrossFade(0.5).toDestination();
        const mainCompressor = new Tone.Compressor(-24, 3).toDestination();

        function createDeck() {
            const player = new Tone.Player({ loop: true });
            const eq = new Tone.EQ3(0, 0, 0);
            const filter = new Tone.Filter(20000, "lowpass");
            const vol = new Tone.Volume(0);
            player.chain(eq, filter, vol);
            return { player, eq, filter, vol };
        }

        const d1 = createDeck(); d1.player.connect(xfade.a);
        const d2 = createDeck(); d2.player.connect(xfade.b);
        const synth = new Tone.PolySynth(Tone.Synth).toDestination();

        // --- 2. äº¤äº’é‚è¼¯ ---
        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('active'); }
        function showPage(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            toggleSidebar();
        }

        // --- 3. DJ æ§åˆ¶ ---
        async function loadBuffer(e, deck) {
            const url = URL.createObjectURL(e.target.files[0]);
            const target = deck === 'a' ? d1 : d2;
            await target.player.load(url);
            alert(`Deck ${deck.toUpperCase()} å·²æˆåŠŸåŠ è¼‰éŸ³è»Œ`);
        }

        function playDeck(deck) {
            const target = deck === 'a' ? d1.player : d2.player;
            const vinyl = document.getElementById(`vinyl-${deck}`);
            if(target.state === 'started') {
                target.stop();
                vinyl.classList.remove('spinning');
            } else {
                if(target.loaded) {
                    Tone.start();
                    target.start();
                    vinyl.classList.add('spinning');
                } else alert("è«‹å…ˆä¸Šå‚³éŸ³è»Œï¼");
            }
        }

        // --- 4. 8x8 Sampler ç”Ÿæˆ ---
        const padContainer = document.getElementById('pad-container');
        for(let i=0; i<64; i++) {
            const pad = document.createElement('div');
            pad.className = 'pad';
            pad.onmousedown = () => {
                // é€™è£¡å¯ä»¥æ ¹æ“š setSamplerLib ç¶å®šä¸åŒçš„ Wav æª”æ¡ˆ
                synth.triggerAttackRelease("C2", "8n");
            };
            padContainer.appendChild(pad);
        }

        // --- 5. é‹¼ç´éµç›¤ç”Ÿæˆ ---
        const piano = document.getElementById('piano');
        const notes = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];
        for(let oct=3; oct<=5; oct++) {
            notes.forEach(note => {
                const key = document.createElement('div');
                key.className = note.includes('#') ? 'b-key' : 'w-key';
                key.onmousedown = () => synth.triggerAttack(`${note}${oct}`);
                key.onmouseup = () => synth.triggerRelease(`${note}${oct}`);
                piano.appendChild(key);
            });
        }
    </script>
</body>
</html>
